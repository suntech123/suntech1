


AZU_SD.._EUZ..._DEV_DEV... (The Role)

This represents the Active Role you are currently using.
Significance: In Snowflake, you don't just "log in"; you assume a specific Role. This role determines what you are allowed to see and do.
Naming Convention Breakdown:
AZU: Likely indicates the cloud platform is Azure.
SDRP / EUZDS: These appear to be internal codes for your specific project, department, or business unit.
DEV: Indicates this is the Development environment (as opposed to Prod/Production).
DEVELOPER: This is the access level. It likely grants you permission to read/write tables in the Dev database but perhaps restricts you from dropping production tables.


2. EUZDS_DEV_PIMS_WH (X-Small) (The Warehouse)
This represents the Virtual Warehouse (Compute Power) assigned to run your queries.
Significance: While the Database holds your data, the Warehouse provides the CPU and Memory to actually execute the SQL. If this is not running, you cannot run queries.


Naming Convention Breakdown:

EUZDS_DEV_PIMS: The project or application this warehouse belongs to. "PIMS" is likely the specific system name (e.g., Product Information Management System).
_WH: A standard suffix standing for Warehouse.
(X-Small): This is the Size of the server cluster.
X-Small is the smallest size (1 node).
It costs 1 Credit per hour to run.
Larger sizes (Small, Medium, Large, etc.) are faster but cost significantly more.
Summary
When you hit "Run" in that worksheet, Snowflake is effectively saying:
"Using the permissions of the Dev Developer Role, wake up the X-Small PIMS Warehouse to compute this query."











Step 2.

Select * from EUIDS_DEV_PIMS_DB.PIMS_DEV.POLDIG_DOCUMENT_T where DOC_GLOBAL_DOC_ID = '';



Step 5.

select DOC.documentid , CPT_TEMP.PROC_CD ,CPT_TEMP.COV_DSCN_IND,
       CPT_TEMP.COV_DSCN_RSN, CPT_TEMP.COV_DSCN_REF,
FROM EUIDS_DEV_PIMS_DB.PIMS_DEV.POLDIG_CPTCODE_T CPT_STAGE
INNER JOIN EUIDS_DEV_PIMS_AI_DB.PIMS_AI_DEV.POLDIG_WORKING_CPTCODE_T_TEMP_DELTA_TEST CPT_TEMP
INNER JOIN EUIDS_DEV_PIMS_DB.PIMS_DEV.POLDIG_DOCUMENT_T DOC
ON CPT_TEMP.documentid = DOC.documentid
and CPT_TEMP.documentid = CPT_STAGE.documentid
and CPT_TEMP.PROC_CD = CPT_STAGE.PROC_CD
and (CPT_TEMP.COV_DSCN_IND <> CPT_STAGE.COV_DSCN_IND or CPT_TEMP.COV_DSCN_REF <> CPT_STAGE.COV_DSCN_REF)
and DOC.DOC_GLOBAL_DOC_ID in (
'3e208829-ba5f-445a-a13f-944504b645ea',
'30fc4c98-a824-4523-a742-82ce6b537b34'
) and (CPT_TEMP.COV_DSCN_IND is not null or CPT_TEMP.COV_DSCN_IND <> '')


Step 6.

MERGE INTO EUIDS_DEV_PIMS_DB.PIMS_DEV.POLDIG_CPTCODE_T DEST
USING (
    select DOC.documentid , CPT_TEMP.PROC_CD ,CPT_TEMP.COV_DSCN_IND,
           CPT_TEMP.COV_DSCN_RSN, CPT_TEMP.COV_DSCN_REF,
    FROM EUIDS_DEV_PIMS_DB.PIMS_DEV.POLDIG_CPTCODE_T CPT_STAGE
    INNER JOIN EUIDS_DEV_PIMS_AI_DB.PIMS_AI_DEV.POLDIG_WORKING_CPTCODE_T_TEMP_DELTA_TEST CPT_TEMP
    INNER JOIN EUIDS_DEV_PIMS_DB.PIMS_DEV.POLDIG_DOCUMENT_T DOC
    ON CPT_TEMP.documentid = DOC.documentid
    and CPT_TEMP.documentid = CPT_STAGE.documentid
    and CPT_TEMP.PROC_CD = CPT_STAGE.PROC_CD
    and (CPT_TEMP.COV_DSCN_IND <> CPT_STAGE.cov_dscn_ind or CPT_TEMP.COV_DSCN_REF <> CPT_STAGE.COV_DSCN_REF)
    and DOC.DOC_GLOBAL_DOC_ID in (
        '3e208829-ba5f-445a-a13f-944504b645ea',
        '30fc4c98-a824-4523-a742-82ce6b537b34'
    ) and (CPT_TEMP.COV_DSCN_IND is not null or CPT_TEMP.COV_DSCN_IND <> '')
) AS UPD
ON UPD.documentid=DEST.documentid
and UPD.PROC_CD=DEST.PROC_CD
WHEN MATCHED THEN
UPDATE SET
    DEST.COV_DSCN_IND=UPD.COV_DSCN_IND,
    DEST.COV_DSCN_RSN=UPD.COV_DSCN_RSN,
    DEST.COV_DSCN_REF = UPD.COV_DSCN_REF ;

